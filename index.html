<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<title>RIX | Raebareli Industrial Exchange</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root {
  --bg: #020617; --surface: #0f172a; --card: #1e293b;
  --text: #f8fafc; --muted: #64748b; --border: rgba(255,255,255,0.08); 
  --primary: #3b82f6; --gold: #fbbf24; --green: #10b981;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { 
  margin: 0; background: var(--bg); color: var(--text); 
  font-family: 'Plus Jakarta Sans', sans-serif; overflow-x: hidden;
}

/* --- SPLASH SCREEN --- */
#splash {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: var(--bg); z-index: 9999;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  transition: opacity 0.8s ease;
}
.logo-anim {
  font-size: 72px; font-weight: 800; letter-spacing: -4px;
  background: linear-gradient(to bottom, #fff, #3b82f6);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  animation: pulse 1.5s infinite;
}
.loader-bar {
  width: 120px; height: 4px; background: #111; border-radius: 10px;
  margin-top: 20px; overflow: hidden;
}
.loader-progress {
  width: 100%; height: 100%; background: var(--primary);
  animation: load 2s ease-in-out; transform-origin: left;
}
@keyframes pulse { 0% { opacity: 0.5; transform: scale(0.95); } 50% { opacity: 1; transform: scale(1); } 100% { opacity: 0.5; transform: scale(0.95); } }
@keyframes load { 0% { transform: scaleX(0); } 100% { transform: scaleX(1); } }

/* --- MAIN INTERFACE --- */
#app-content { opacity: 0; transition: opacity 1s ease; padding-bottom: 120px; }
header { padding: 60px 24px 30px; text-align: center; border-bottom: 1px solid var(--border); }
h1 { font-size: 48px; font-weight: 800; margin: 0; letter-spacing: -2px; }
.subtitle { color: var(--primary); font-size: 11px; font-weight: 800; letter-spacing: 2px; text-transform: uppercase; }

.controls { position: sticky; top: 0; z-index: 100; background: rgba(2, 6, 23, 0.9); backdrop-filter: blur(15px); padding: 15px; border-bottom: 1px solid var(--border); }
input, select { width: 100%; padding: 15px; border-radius: 15px; border: 1px solid var(--border); background: var(--surface); color: white; font-size: 16px; margin-bottom: 10px; }

#feed { max-width: 700px; margin: auto; padding: 15px; display: grid; gap: 15px; }
.card { background: var(--surface); border: 1px solid var(--border); border-radius: 25px; padding: 20px; position: relative; }
.card.premium { border: 1px solid var(--gold); background: linear-gradient(145deg, #0f172a, #020617); }
.card.premium::after { content: 'PREMIUM'; position: absolute; top: 0; right: 0; background: var(--gold); color: #000; font-size: 9px; font-weight: 900; padding: 4px 12px; border-bottom-left-radius: 12px; }

.c-title { font-size: 22px; font-weight: 800; margin-bottom: 5px; }
.c-loc { font-size: 13px; color: var(--muted); margin-bottom: 15px; }
.tag-row { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 15px; }
.tag { font-size: 10px; padding: 5px 10px; border-radius: 6px; background: rgba(255,255,255,0.05); color: var(--muted); font-weight: 700; border: 1px solid var(--border); }

.actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.btn { padding: 14px; border-radius: 14px; text-align: center; text-decoration: none; font-weight: 800; font-size: 13px; display: flex; align-items: center; justify-content: center; gap: 8px; border: none; cursor: pointer; }
.btn-call { background: var(--card); color: white; border: 1px solid var(--border); }
.btn-wa { background: var(--primary); color: white; }

/* Admin dashboard */
#admin-box { display: none; background: #000; padding: 20px; border-bottom: 2px solid var(--primary); }
.stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.stat-item { background: #111; padding: 15px; border-radius: 15px; }
.stat-item small { font-size: 9px; color: var(--muted); text-transform: uppercase; }
.stat-item div { font-size: 22px; font-weight: 800; margin-top: 5px; }

nav { position: fixed; bottom: 20px; left: 20px; right: 20px; background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(20px); border: 1px solid var(--border); border-radius: 25px; display: flex; justify-content: space-around; padding: 15px; z-index: 2000; }
.nav-i { font-size: 24px; cursor: pointer; }
.fab { background: var(--primary); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; margin-top: -45px; border: 5px solid var(--bg); font-size: 30px; color: white; }
</style>
</head>
<body>

<div id="splash">
  <div class="logo-anim">RIX</div>
  <div style="font-size: 10px; letter-spacing: 3px; color: var(--muted); margin-top: 5px;">RAEBARELI INDUSTRIAL</div>
  <div class="loader-bar"><div class="loader-progress"></div></div>
</div>

<div id="admin-box">
  <div style="display:flex; justify-content:space-between; margin-bottom:15px;"><b style="color:var(--primary)">ADMIN COMMAND</b> <button onclick="exitAdm()" style="background:#333;color:#fff;border:none;padding:5px;border-radius:5px">X</button></div>
  <div class="stat-grid">
    <div class="stat-item"><small>Total Units</small><div id="ad-tot">0</div></div>
    <div class="stat-item"><small>Total Rev</small><div id="ad-rev" style="color:var(--green)">‚Çπ0</div></div>
  </div>
</div>

<div id="app-content">
  <header>
    <h1>RIX</h1>
    <div class="subtitle">Secured Industrial Network</div>
  </header>

  <div class="controls">
    <input type="text" placeholder="Search factory, area, sector..." oninput="doSearch(this.value)">
    <select id="catSelect" onchange="doFilter(this.value)"><option value="">All Sectors</option></select>
  </div>

  <main id="feed"></main>

  <nav>
    <div class="nav-i" onclick="window.scrollTo(0,0)">üè†</div>
    <a href="https://wa.me/918146518503" class="fab">+</a>
    <div class="nav-i" onclick="doShare()">üì§</div>
    <div class="nav-i" onclick="doLogin()">üõ°Ô∏è</div>
  </nav>
</div>

<script>
const URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSV8re2vW-TnHXqnW6LRXuwcU_NJScWKEj-EL9M0Ou6t3CAuUg4oeILRlfllGtVvm6FThUqBhBfsDs4/pub?output=csv";
const HASH = "0608679d63c5008064436894080183e8784918e7e17042079090b8216c55209c"; // Password: rix786

let DB = [], VIEW = [], isAdm = false;

// Handle Splash
window.addEventListener('load', () => {
  setTimeout(() => {
    document.getElementById('splash').style.opacity = '0';
    document.getElementById('app-content').style.opacity = '1';
    setTimeout(() => document.getElementById('splash').remove(), 800);
  }, 2000);
});

async function load() {
  Papa.parse(URL, {
    download: true, header: true,
    complete: r => {
      DB = r.data.filter(x => x["Shop name"]);
      VIEW = [...DB];
      const sel = document.getElementById('catSelect');
      [...new Set(DB.map(x => x.Category))].forEach(c => {
        const o = document.createElement('option'); o.value = c; o.text = c; sel.add(o);
      });
      render();
    }
  });
}

function render() {
  const container = document.getElementById('feed');
  container.innerHTML = VIEW.map(x => {
    const isP = x.Premium === 'yes' && x.PaymentStatus === 'paid';
    return `
      <div class="card ${isP ? 'premium' : ''}">
        <div class="c-title">${x["Shop name"]}</div>
        <div class="c-loc">üìç ${x.Location}, ${x.City}</div>
        <div class="tag-row">
          <span class="tag">${x.Category}</span>
          ${x.Verified === 'yes' ? '<span class="tag" style="color:var(--green)">VERIFIED ‚úì</span>' : ''}
          <span class="tag">‚≠ê ${x.Rating || '5.0'}</span>
        </div>
        <div class="actions">
          <a href="tel:${x["Phone No."]}" class="btn btn-call">CALL</a>
          <a href="https://wa.me/91${String(x["Phone No."]).replace(/\D/g,'')}" class="btn btn-wa">WHATSAPP</a>
        </div>
        ${isAdm ? `<div style="font-size:10px; color:var(--muted); margin-top:10px; border-top:1px dashed #333; padding-top:10px;">
          Agent: ${x.AgentID} | Comm: ‚Çπ${x.AgentCommission} | Status: ${x.PaymentStatus}
        </div>` : ''}
      </div>`;
  }).join('');
}

function doSearch(q) {
  q = q.toLowerCase();
  VIEW = DB.filter(x => x["Shop name"].toLowerCase().includes(q) || x.Category.toLowerCase().includes(q) || x.Location.toLowerCase().includes(q));
  render();
}

function doFilter(c) {
  VIEW = c ? DB.filter(x => x.Category === c) : DB;
  render();
}

async function doLogin() {
  if(isAdm) return;
  const p = prompt("ENTER RIX ADMIN KEY:");
  if(!p) return;
  const msg = new TextEncoder().encode(p.trim().toLowerCase());
  const hashB = await crypto.subtle.digest('SHA-256', msg);
  const hex = Array.from(new Uint8Array(hashB)).map(b => b.toString(16).padStart(2,'0')).join('');
  if(hex === HASH) {
    isAdm = true;
    document.getElementById('admin-box').style.display = 'block';
    document.getElementById('ad-tot').innerText = DB.length;
    document.getElementById('ad-rev').innerText = "‚Çπ" + DB.reduce((s,x) => s + (Number(x.AgentCommission)||0), 0);
    render();
    alert("WELCOME BOSS");
  } else alert("DENIED");
}

function exitAdm() { isAdm = false; document.getElementById('admin-box').style.display = 'none'; render(); }

function doShare() {
  if(navigator.share) navigator.share({title:'RIX Network', url: 'https://shivanshmaurya01.github.io/RIX/'});
  else alert('https://shivanshmaurya01.github.io/RIX/');
}

load();
</script>
</body>
</html>
